(self["webpackChunkhydro_flex_control"]=self["webpackChunkhydro_flex_control"]||[]).push([[7664],{33558:function(t,n,a){var e=a(86619);e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[t.id,e,""]]),e.locals&&(t.exports=e.locals);var o=a(69333).A;o("6c3734fa",e,!0,{sourceMap:!1,shadowMode:!1})},18794:function(t,n,a){"use strict";var e;a.r(n),a.d(n,{default:function(){return z}});var o,i,r,c,s,p,u,d,l,h,v,g,f=function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("v-uni-view",{staticClass:"container"},[a("v-uni-view",{staticClass:"page-body uni-content-info"},[a("v-uni-view",{staticClass:"cropper-content"},[t.isShowImg?a("v-uni-view",{staticClass:"uni-corpper",style:"width:"+t.cropperInitW+"px;height:"+t.cropperInitH+"px;background:#000"},[a("v-uni-view",{staticClass:"uni-corpper-content",style:"width:"+t.cropperW+"px;height:"+t.cropperH+"px;left:"+t.cropperL+"px;top:"+t.cropperT+"px"},[a("v-uni-image",{style:"width:"+t.cropperW+"px;height:"+t.cropperH+"px",attrs:{src:t.imageSrc}}),a("v-uni-view",{staticClass:"uni-corpper-crop-box",style:"left:"+t.cutL+"px;top:"+t.cutT+"px;right:"+t.cutR+"px;bottom:"+t.cutB+"px",on:{touchstart:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.contentStartMove.apply(void 0,arguments)},touchmove:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.contentMoveing.apply(void 0,arguments)},touchend:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.contentTouchEnd.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"uni-cropper-view-box"},[a("v-uni-view",{staticClass:"uni-cropper-dashed-h"}),a("v-uni-view",{staticClass:"uni-cropper-dashed-v"}),a("v-uni-view",{staticClass:"uni-cropper-line-t",attrs:{"data-drag":"top"},on:{touchstart:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragStart.apply(void 0,arguments)},touchmove:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-line-r",attrs:{"data-drag":"right"},on:{touchstart:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragStart.apply(void 0,arguments)},touchmove:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-line-b",attrs:{"data-drag":"bottom"},on:{touchstart:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragStart.apply(void 0,arguments)},touchmove:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-line-l",attrs:{"data-drag":"left"},on:{touchstart:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragStart.apply(void 0,arguments)},touchmove:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-point point-t",attrs:{"data-drag":"top"},on:{touchstart:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragStart.apply(void 0,arguments)},touchmove:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-point point-tr",attrs:{"data-drag":"topTight"}}),a("v-uni-view",{staticClass:"uni-cropper-point point-r",attrs:{"data-drag":"right"},on:{touchstart:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragStart.apply(void 0,arguments)},touchmove:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-point point-rb",attrs:{"data-drag":"rightBottom"},on:{touchstart:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragStart.apply(void 0,arguments)},touchmove:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-point point-b",attrs:{"data-drag":"bottom"},on:{touchstart:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragStart.apply(void 0,arguments)},touchmove:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragMove.apply(void 0,arguments)},touchend:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragEnd.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-point point-bl",attrs:{"data-drag":"bottomLeft"}}),a("v-uni-view",{staticClass:"uni-cropper-point point-l",attrs:{"data-drag":"left"},on:{touchstart:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragStart.apply(void 0,arguments)},touchmove:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.dragMove.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"uni-cropper-point point-lt",attrs:{"data-drag":"leftTop"}})],1)],1)],1)],1):t._e()],1),a("v-uni-view",{staticClass:"cropper-config"},[a("v-uni-button",{staticStyle:{"margin-top":"30rpx"},attrs:{type:"primary reverse"},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.getImage.apply(void 0,arguments)}}},[t._v("选择头像")]),a("v-uni-button",{staticStyle:{"margin-top":"30rpx"},attrs:{type:"warn"},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.getImageInfo.apply(void 0,arguments)}}},[t._v("提交")])],1),a("v-uni-canvas",{style:"position:absolute;border: 1px solid red; width:"+t.imageW+"px;height:"+t.imageH+"px;top:-9999px;left:-9999px;",attrs:{"canvas-id":"myCanvas"}})],1)],1)},m=[],b=(a(79432),a(26099),a(23500),a(46920)),w=a(62008),y=(a(27358),defaultConfig.baseUrl),x=uni.getSystemInfoSync(),k=x.screenWidth,P=(x.pixelRatio,1),E=100,C=x.screenWidth,T={data:function(){return{imageSrc:b.A.getters.avatar,isShowImg:!1,cropperInitW:k,cropperInitH:k,cropperW:k,cropperH:k,cropperL:0,cropperT:0,transL:0,transT:0,scaleP:0,imageW:0,imageH:0,cutL:0,cutT:0,cutB:k,cutR:"100%",qualityWidth:C,innerAspectRadio:P}},onReady:function(){this.loadImage()},methods:{setData:function(t){var n=this;Object.keys(t).forEach((function(a){n.$set(n.$data,a,t[a])}))},getImage:function(){var t=this;uni.chooseImage({success:function(n){t.setData({imageSrc:n.tempFilePaths[0]}),t.loadImage()}})},loadImage:function(){var t=this;uni.getImageInfo({src:t.imageSrc,success:function(n){l=1,l>=1?(h=k,v=k/l):(h=k*l,v=k);var a=h>v?h:v;if(E=a>E?E:a,l>=1){var e=Math.ceil((k/l-(k/l-E))/2),o=e,i=Math.ceil((k-k+E)/2),r=i;t.setData({cropperW:k,cropperH:k/l,cropperL:Math.ceil((k-k)/2),cropperT:Math.ceil((k-k/l)/2),cutL:i,cutT:e,cutR:r,cutB:o,imageW:h,imageH:v,scaleP:h/k,qualityWidth:C,innerAspectRadio:l})}else{var c=Math.ceil((k*l-k*l)/2),s=c,p=Math.ceil((k-E)/2),u=p;t.setData({cropperW:k*l,cropperH:k,cropperL:Math.ceil((k-k*l)/2),cropperT:Math.ceil((k-k)/2),cutL:c,cutT:p,cutR:s,cutB:u,imageW:h,imageH:v,scaleP:h/k,qualityWidth:C,innerAspectRadio:l})}t.setData({isShowImg:!0}),uni.hideLoading()}})},contentStartMove:function(t){o=t.touches[0].pageX,i=t.touches[0].pageY},contentMoveing:function(t){var n=(o-t.touches[0].pageX)*P,a=(i-t.touches[0].pageY)*P;n>0?this.cutL-n<0&&(n=this.cutL):this.cutR+n<0&&(n=-this.cutR),a>0?this.cutT-a<0&&(a=this.cutT):this.cutB+a<0&&(a=-this.cutB),this.setData({cutL:this.cutL-n,cutT:this.cutT-a,cutR:this.cutR+n,cutB:this.cutB+a}),o=t.touches[0].pageX,i=t.touches[0].pageY},contentTouchEnd:function(){},getImageInfo:function(){var t=this;uni.showLoading({title:"图片生成中..."});var n=uni.createCanvasContext("myCanvas");n.drawImage(t.imageSrc,0,0,h,v),n.draw(!0,(function(){var n=(t.cropperW-t.cutL-t.cutR)/t.cropperW*h,a=(t.cropperH-t.cutT-t.cutB)/t.cropperH*v,e=t.cutL/t.cropperW*h,o=t.cutT/t.cropperH*v;uni.canvasToTempFilePath({x:e,y:o,width:n,height:a,destWidth:n,destHeight:a,quality:.5,canvasId:"myCanvas",success:function(t){uni.hideLoading();var n={name:"avatarfile",filePath:t.tempFilePath};(0,w.F4)(n).then((function(t){b.A.commit("SET_AVATAR",y+t.imgUrl),uni.showToast({title:"修改成功",icon:"success"}),uni.navigateBack()}))}})}))},dragStart:function(t){r=t.touches[0].pageX,c=t.touches[0].pageY,s=this.cutL,u=this.cutR,d=this.cutB,p=this.cutT},dragMove:function(t){var n=t.target.dataset.drag;switch(n){case"right":var a=(r-t.touches[0].pageX)*P;u+a<0&&(a=-u),this.setData({cutR:u+a});break;case"left":a=(r-t.touches[0].pageX)*P;s-a<0&&(a=s),s-a>this.cropperW-this.cutR&&(a=s-(this.cropperW-this.cutR)),this.setData({cutL:s-a});break;case"top":a=(c-t.touches[0].pageY)*P;p-a<0&&(a=p),p-a>this.cropperH-this.cutB&&(a=p-(this.cropperH-this.cutB)),this.setData({cutT:p-a});break;case"bottom":a=(c-t.touches[0].pageY)*P;d+a<0&&(a=-d),this.setData({cutB:d+a});break;case"rightBottom":var e=(r-t.touches[0].pageX)*P,o=(c-t.touches[0].pageY)*P;d+o<0&&(o=-d),u+e<0&&(e=-u);var i=d+o,l=u+e;this.setData({cutB:i,cutR:l});break;default:break}}}},$=T,M=(a(33558),a(18535)),S=(0,M.A)($,f,m,!1,null,"58a22c36",null,!1,e,g),z=S.exports},86619:function(t,n,a){"use strict";a.r(n);var e=a(45522),o=a.n(e),i=a(67643),r=a.n(i),c=r()(o());c.push([t.id,'\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* pages/uni-cropper/index.wxss */.uni-content-info[data-v-58a22c36]{\n\t/* position: fixed;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tdisplay: block;\n\talign-items: center;\n\tflex-direction: column; */}.cropper-config[data-v-58a22c36]{padding:%?20?% %?40?%}.cropper-content[data-v-58a22c36]{min-height:%?750?%;width:100%}.uni-corpper[data-v-58a22c36]{position:relative;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;box-sizing:border-box}.uni-corpper-content[data-v-58a22c36]{position:relative}.uni-corpper-content uni-image[data-v-58a22c36]{display:block;width:100%;min-width:0!important;max-width:none!important;height:100%;min-height:0!important;max-height:none!important;image-orientation:0deg!important;margin:0 auto}\n\n/* 移动图片效果 */.uni-cropper-drag-box[data-v-58a22c36]{position:absolute;top:0;right:0;bottom:0;left:0;cursor:move;background:rgba(0,0,0,.6);z-index:1}\n\n/* 内部的信息 */.uni-corpper-crop-box[data-v-58a22c36]{position:absolute;background:hsla(0,0%,100%,.3);z-index:2}.uni-corpper-crop-box .uni-cropper-view-box[data-v-58a22c36]{position:relative;display:block;width:100%;height:100%;overflow:visible;outline:%?1?% solid #69f;outline-color:rgba(102,153,255,.75)}\n\n/* 横向虚线 */.uni-cropper-dashed-h[data-v-58a22c36]{position:absolute;top:33.33333333%;left:0;width:100%;height:33.33333333%;border-top:%?1?% dashed hsla(0,0%,100%,.5);border-bottom:%?1?% dashed hsla(0,0%,100%,.5)}\n\n/* 纵向虚线 */.uni-cropper-dashed-v[data-v-58a22c36]{position:absolute;left:33.33333333%;top:0;width:33.33333333%;height:100%;border-left:%?1?% dashed hsla(0,0%,100%,.5);border-right:%?1?% dashed hsla(0,0%,100%,.5)}\n\n/* 四个方向的线  为了之后的拖动事件*/.uni-cropper-line-t[data-v-58a22c36]{position:absolute;display:block;width:100%;background-color:#69f;top:0;left:0;height:%?1?%;opacity:.1;cursor:n-resize}.uni-cropper-line-t[data-v-58a22c36]::before{content:"";position:absolute;top:50%;right:%?0?%;width:100%;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0);bottom:0;height:%?41?%;background:transparent;z-index:11}.uni-cropper-line-r[data-v-58a22c36]{position:absolute;display:block;background-color:#69f;top:0;right:%?0?%;width:%?1?%;opacity:.1;height:100%;cursor:e-resize}.uni-cropper-line-r[data-v-58a22c36]::before{content:"";position:absolute;top:0;left:50%;width:%?41?%;-webkit-transform:translate3d(-50%,0,0);transform:translate3d(-50%,0,0);bottom:0;height:100%;background:transparent;z-index:11}.uni-cropper-line-b[data-v-58a22c36]{position:absolute;display:block;width:100%;background-color:#69f;bottom:0;left:0;height:%?1?%;opacity:.1;cursor:s-resize}.uni-cropper-line-b[data-v-58a22c36]::before{content:"";position:absolute;top:50%;right:%?0?%;width:100%;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0);bottom:0;height:%?41?%;background:transparent;z-index:11}.uni-cropper-line-l[data-v-58a22c36]{position:absolute;display:block;background-color:#69f;top:0;left:0;width:%?1?%;opacity:.1;height:100%;cursor:w-resize}.uni-cropper-line-l[data-v-58a22c36]::before{content:"";position:absolute;top:0;left:50%;width:%?41?%;-webkit-transform:translate3d(-50%,0,0);transform:translate3d(-50%,0,0);bottom:0;height:100%;background:transparent;z-index:11}.uni-cropper-point[data-v-58a22c36]{width:%?5?%;height:%?5?%;background-color:#69f;opacity:.75;position:absolute;z-index:3}.point-t[data-v-58a22c36]{top:%?-3?%;left:50%;margin-left:%?-3?%;cursor:n-resize}.point-tr[data-v-58a22c36]{top:%?-3?%;left:100%;margin-left:%?-3?%;cursor:n-resize}.point-r[data-v-58a22c36]{top:50%;left:100%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}.point-rb[data-v-58a22c36]{left:100%;top:100%;-webkit-transform:translate3d(-50%,-50%,0);transform:translate3d(-50%,-50%,0);cursor:n-resize;width:%?36?%;height:%?36?%;background-color:#69f;position:absolute;z-index:1112;opacity:1}.point-b[data-v-58a22c36]{left:50%;top:100%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}.point-bl[data-v-58a22c36]{left:0;top:100%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}.point-l[data-v-58a22c36]{left:0;top:50%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}.point-lt[data-v-58a22c36]{left:0;top:0;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize}\n\n/* 裁剪框预览内容 */.uni-cropper-viewer[data-v-58a22c36]{position:relative;width:100%;height:100%;overflow:hidden}.uni-cropper-viewer uni-image[data-v-58a22c36]{position:absolute;z-index:2}',""]),n["default"]=c},62008:function(t,n,a){"use strict";a.d(n,{F4:function(){return s},VM:function(){return r},cO:function(){return i},eg:function(){return c}});var e=a(29987),o=a(41325);function i(t,n){var a={oldPassword:t,newPassword:n};return(0,o.A)({url:"/system/user/profile/updatePwd",method:"put",params:a})}function r(){return(0,o.A)({url:"/system/user/profile",method:"get"})}function c(t){return(0,o.A)({url:"/system/user/profile",method:"put",data:t})}function s(t){return(0,e.A)({url:"/system/user/profile/avatar",name:t.name,filePath:t.filePath})}},29987:function(t,n,a){"use strict";a(74423),a(34782),a(2892),a(79432),a(26099),a(21699);var e=a(46920),o=a(84300),i=a(18471),r=a(50771),c=a(27358),s=1e4,p=function(t){var n=!1===(t.headers||{}).isToken;if(t.header=t.header||{},(0,o.gf)()&&!n&&(t.header["Authorization"]="Bearer "+(0,o.gf)()),t.params){var a=t.url+"?"+(0,r.HE)(t.params);a=a.slice(0,-1),t.url=a}return new Promise((function(n,a){uni.uploadFile({timeout:t.timeout||s,url:t.baseUrl||c.baseUrl+t.url,file:t.file||"",fileType:"image",name:t.name||"file",header:t.header,success:function(t){var o=JSON.parse(t.data),c=Number(o.code)||200,s=i.A[c]||o.msg||i.A["default"];200===c||-1===c?n(o):401==c?((0,r.GQ)("登录状态已过期，您可以继续留在该页面，或者重新登录?").then((function(t){t.confirm&&e.A.dispatch("LogOut").then((function(t){uni.reLaunch({url:"/pages/login/login"})}))})),a("无效的会话，或者会话已过期，请重新登录。")):500===c?((0,r.oR)(s),a("500")):200!==c&&((0,r.oR)(s),a(c))},fail:function(t){var n=t.message;"Network Error"==n?n="后端接口连接异常":n.includes("timeout")?n="系统接口请求超时":n.includes("Request failed with status code")&&(n="系统接口"+n.substr(n.length-3)+"异常"),(0,r.oR)(n),a(t)}})}))};n.A=p}}]);